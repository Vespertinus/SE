type: VERTEX
source:
 - |
        #version 150

        in vec4 Position;
        in vec2 TexCoord0;

        uniform samplerBuffer BufferTex;
        uniform mat4 MVPMatrix;
        uniform mat4 MVMatrix;
        //TODO rewrite after switching on uniform buffers
        uniform float BS_1W;
        uniform float BS_2W;

        out vec2      TexCoord;

        const int channels_cnt = 2;

        void main() {

                vec3 bs1;
                vec3 bs2;

                bs1.x = texelFetch(BufferTex, (gl_VertexID * 3 * channels_cnt) + 0).x;
                bs1.y = texelFetch(BufferTex, (gl_VertexID * 3 * channels_cnt) + 1).x;
                bs1.z = texelFetch(BufferTex, (gl_VertexID * 3 * channels_cnt) + 2).x;

                bs2.x = texelFetch(BufferTex, (gl_VertexID * 3 * channels_cnt) + 3 + 0).x;
                bs2.y = texelFetch(BufferTex, (gl_VertexID * 3 * channels_cnt) + 3 + 1).x;
                bs2.z = texelFetch(BufferTex, (gl_VertexID * 3 * channels_cnt) + 3 + 2).x;

                vec4 BlendedPosition = vec4(BS_1W * bs1, 0) + vec4(BS_2W * bs2, 0) + Position;

                gl_Position = MVPMatrix * (MVMatrix * BlendedPosition);
                TexCoord    = TexCoord0;
        }

